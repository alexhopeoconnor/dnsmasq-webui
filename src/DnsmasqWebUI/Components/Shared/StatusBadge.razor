@namespace DnsmasqWebUI.Components.Shared

@if (Clickable)
{
    <button type="button"
            class="@CssClass"
            title="@Title"
            aria-label="@(AriaLabel ?? Text)"
            disabled="@Disabled"
            id="@(string.IsNullOrEmpty(Id) ? null : Id)"
            @onclick="OnClick"
            @onclick:stopPropagation="@StopPropagation"
            @onmousedown:preventDefault="@PreventBlurOnMouseDown"
            @onmouseleave="OnMouseLeave">
        @ChildContent
        @if (ChildContent == null && !string.IsNullOrWhiteSpace(IconClass))
        {
            <i class="@IconClass" aria-hidden="true"></i>
            <span class="visually-hidden">@Text</span>
        }
        else if (ChildContent == null)
        {
            @Text
        }
    </button>
}
else
{
    <span class="@CssClass" title="@Title" id="@(string.IsNullOrEmpty(Id) ? null : Id)">
        @ChildContent
        @if (ChildContent == null && !string.IsNullOrWhiteSpace(IconClass))
        {
            <i class="@IconClass" aria-hidden="true"></i>
            <span class="visually-hidden">@Text</span>
        }
        else if (ChildContent == null)
        {
            @Text
        }
    </span>
}

@code {
    [Parameter] public StatusBadgeKind Kind { get; set; }
    [Parameter] public string Text { get; set; } = "";
    [Parameter] public bool Clickable { get; set; }
    [Parameter] public bool Disabled { get; set; }
    [Parameter] public string? Title { get; set; }
    [Parameter] public string? AriaLabel { get; set; }
    [Parameter] public string? Id { get; set; }
    [Parameter] public string? IconClass { get; set; }
    [Parameter] public bool StopPropagation { get; set; } = true;
    [Parameter] public bool PreventBlurOnMouseDown { get; set; }
    [Parameter] public EventCallback OnClick { get; set; }
    [Parameter] public EventCallback OnMouseLeave { get; set; }
    [Parameter] public string? Class { get; set; }
    [Parameter] public RenderFragment? ChildContent { get; set; }

    private string CssClass
    {
        get
        {
            var kindClass = Kind switch
            {
                StatusBadgeKind.Managed => "bg-primary",
                StatusBadgeKind.SourceMain => "bg-secondary",
                StatusBadgeKind.SourceInclude => "bg-secondary",
                StatusBadgeKind.Editable => "bg-primary",
                StatusBadgeKind.ReadOnly => "bg-secondary",
                StatusBadgeKind.Pending => "bg-warning text-dark",
                StatusBadgeKind.ActionOk => "bg-success",
                StatusBadgeKind.ActionCancel => "bg-secondary",
                StatusBadgeKind.ActionRevert => "bg-danger",
                StatusBadgeKind.NeutralPill => "bg-light text-dark border rounded-pill",
                _ => "bg-secondary"
            };
            return $"badge status-badge {kindClass} {Class}".Trim();
        }
    }
}
