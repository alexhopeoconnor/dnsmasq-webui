@namespace DnsmasqWebUI.Components.EffectiveConfig.CustomDisplays
@using DnsmasqWebUI.Models.Dnsmasq
@inherits EffectiveConfigValueDisplayBase

@* local-service: net | host. Pending value shown until save. *@
@if (IsActiveEditor && Descriptor.GetSource()?.IsReadOnly != true)
{
    <select class="form-select form-select-sm" style="max-width: 10rem;" value="@(GetEffectiveDisplayValue() as string ?? "")" @onchange="OnChange" @onfocusout="OnCommitRequested">
        <option value="">(not set)</option>
        <option value="net">net</option>
        <option value="host">host</option>
    </select>
}
else
{
    var v = GetEffectiveDisplayValue() as string;
    @(string.IsNullOrEmpty(v) ? "(not set)" : (v.Trim().ToLowerInvariant() is "net" or "host" ? v.Trim() : v))
}

@code {
    private async Task OnChange(ChangeEventArgs e)
    {
        var v = e.Value?.ToString()?.Trim();
        var value = string.IsNullOrEmpty(v) ? null : (v == "net" || v == "host" ? v : null);
        await NotifyValueChanged(value);
    }
}
