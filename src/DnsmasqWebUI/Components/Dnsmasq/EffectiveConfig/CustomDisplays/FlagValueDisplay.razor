@namespace DnsmasqWebUI.Components.Dnsmasq.EffectiveConfig.CustomDisplays
@using DnsmasqWebUI.Models.Dnsmasq

@* Reusable value-only display for boolean/flag options. When active editor: checkbox (unless readonly); View: "Enabled" / "Disabled". *@
@if (IsActiveEditor && Descriptor.GetSource()?.IsReadOnly != true)
{
    var isSet = Descriptor.GetValue() is bool b && b;
    <input type="checkbox" class="form-check-input" checked="@isSet" @onchange="OnCheckedChange" @onfocusout="OnCommitRequested" />
}
else
{
    @(Descriptor.GetValue() is bool isSet && isSet ? "Enabled" : "Disabled")
}

@code {
    [Parameter] public EffectiveConfigFieldDescriptor Descriptor { get; set; } = null!;
    [CascadingParameter] public bool IsActiveEditor { get; set; }
    [CascadingParameter] public EventCallback<FocusEventArgs> OnCommitRequested { get; set; }
    [Parameter] public EventCallback<object?> ValueChanged { get; set; }

    private async Task OnCheckedChange(ChangeEventArgs e)
    {
        await ValueChanged.InvokeAsync(e.Value is true);
    }
}
