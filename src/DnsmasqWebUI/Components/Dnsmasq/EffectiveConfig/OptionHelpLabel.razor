@namespace DnsmasqWebUI.Components.Dnsmasq.EffectiveConfig
@using DnsmasqWebUI.Models.Dnsmasq.EffectiveConfig

<span id="@AnchorId" class="@EffectiveCssClass" title="@Title" @onclick="OnClick" @onmouseleave="OnMouseLeave">
    @ChildContent
</span>

@code {
    [Parameter] public string AnchorId { get; set; } = "";
    [Parameter] public string? HelpKey { get; set; }
    [Parameter] public string OptionLabel { get; set; } = "";
    [Parameter] public string? CssClass { get; set; }

    private string EffectiveCssClass =>
        CssClass ?? (!string.IsNullOrEmpty(HelpKey) ? "ec-field-label ec-field-label-help" : "ec-field-label");
    [Parameter] public string? Title { get; set; }
    [CascadingParameter] public EffectiveConfigUiContext? Ui { get; set; }
    [Parameter] public RenderFragment? ChildContent { get; set; }

    private Task OnClick()
    {
        if (Ui == null || string.IsNullOrEmpty(HelpKey)) return Task.CompletedTask;
        return Ui.RequestOptionHelpAsync(new ConfigOptionHelpRequestEventArgs
        {
            HelpKey = HelpKey,
            OptionLabel = OptionLabel,
            AnchorId = AnchorId
        });
    }

    private Task OnMouseLeave()
    {
        if (Ui == null) return Task.CompletedTask;
        return Ui.RequestOptionHelpAsync(new ConfigOptionHelpRequestEventArgs
        {
            AnchorId = AnchorId,
            IsLabelMouseLeave = true
        });
    }
}
